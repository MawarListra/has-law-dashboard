(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[915],{3719:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/publication/[...addEdit]",function(){return n(4821)}])},8545:function(e,t,n){"use strict";n.d(t,{Z:function(){return A}});var a=n(5893),r=n(7294),i=n(5675),l=n.n(i),u=n(7414),s=n(3230),c=n(6527),o=n(9003),d={src:"/_next/static/media/pdf-icon.b1c4466b.jpeg",height:640,width:640,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wAARCAAIAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAf/xAAfEAACAAUFAAAAAAAAAAAAAAAAEQECAxIxBBUhQVH/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8Aol2v3tqeFC7CmUel4ly8AAD/2Q==",blurWidth:8,blurHeight:8},A=function(e){let{name:t,value:n,accept:i,placeholder:A,onChange:p}=e,[m,v]=(0,r.useState)(void 0),h=r.useRef(null),f=e=>{let t=e.target.name,n=e.target.value,a=e.target.files;if(!a||(null==a?void 0:a.length)===0)return;let r=a[0];if(!r.type.includes("image/")&&!r.type.includes("application/pdf")){h.current&&(h.current.value="");return}(null==r?void 0:r.type)==="application/pdf"?v(r):v(void 0),null==p||p(r,{name:t,value:n})};return(0,a.jsxs)(r.Fragment,{children:[n||m?(0,a.jsxs)("div",{className:"relative",children:[m&&void 0!==m?(0,a.jsx)("div",{onClick:()=>{let e=document.createElement("a");e.href=URL.createObjectURL(m||new Blob),e.target="_blank",e.download="".concat(t,".pdf"),e.click()},children:(0,a.jsx)(l(),{className:"img-fluid flex ",src:m?d:"",alt:"Test",width:200,height:150})}):(0,a.jsx)(l(),{className:"img-fluid flex",src:n instanceof Blob?URL.createObjectURL(n):"".concat("https://has.chicodeapi.xyz","/").concat(n),alt:"Test",width:200,height:150}),(0,a.jsxs)("div",{className:"absolute top-3 flex justify-between",style:{width:"200px"},children:[(0,a.jsx)(u.Ei,{className:"mr-2",title:"Ubah Gambar",onClick:()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.click()},children:(0,a.jsx)(c.Z,{color:"blue",size:4})}),(0,a.jsx)(u.Ei,{title:"Hapus Gambar",onClick:()=>{var e;null==p||p(null,{name:null===(e=h.current)||void 0===e?void 0:e.name,value:""}),v(void 0)},children:(0,a.jsx)(o.Z,{color:"red",size:4})})]})]}):(0,a.jsx)(u.UP,{className:"cursor-default",iconRight:(0,a.jsx)(s.Z,{}),onClick:()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.click()},readOnly:!0,name:t,placeholder:A}),(0,a.jsx)("input",{name:t,ref:h,type:"file",onChange:e=>{f(e)},hidden:!0,accept:i,multiple:!0})]})}},1951:function(e,t,n){"use strict";n.d(t,{vt:function(){return j},FU:function(){return p},P$:function(){return g},mG:function(){return P},i4:function(){return y},_r:function(){return c},bn:function(){return s},lM:function(){return m},Qy:function(){return k},rr:function(){return b},ef:function(){return o},IL:function(){return v},Lt:function(){return E},rP:function(){return x},$U:function(){return d},K6:function(){return h},Nm:function(){return F},hl:function(){return w},a6:function(){return A},UJ:function(){return f},gy:function(){return D}});var a=n(5121),r=n(3299),i=(()=>{let e=a.Z.create({baseURL:"https://has.chicodeapi.xyz"});return e.interceptors.request.use(async e=>{let t=await (0,r.getSession)();if(t){let n=t.user.apiToken;e.headers.Authorization="Bearer ".concat(n)}return e}),e.interceptors.response.use(e=>e,e=>{if(a.Z.isAxiosError(e)){var t;null===(t=e.response)||void 0===t||t.status}throw e}),e})(),l=n(7848),u=n(8228);let s=e=>{let{params:t,onSuccess:n,onError:a}=e;return(0,l.a)({queryKey:["ApiGetAllPartnerCategories",t],queryFn:async()=>{let{data:e}=await i.get("/v1/partner_categories/getall",{params:t});return e},keepPreviousData:!0,retry:3,onSuccess:n,onError:a})},c=e=>{let{params:t,onSuccess:n,onError:a}=e;return(0,l.a)({queryKey:["ApiGetAllPartner",t],queryFn:async()=>{let{data:e}=await i.get("/v1/partner/getall",{params:t});return e},keepPreviousData:!0,retry:3,onSuccess:n,onError:a})},o=e=>{let{id:t,onSuccess:n,onError:a}=e;return(0,l.a)({queryKey:["ApiGetOnePartner",t],queryFn:async()=>{let{data:e}=await i.get("/v1/partner/getdetail/".concat(t));return e},enabled:!1,onSuccess:n,onError:a})},d=e=>{let{onSuccess:t,onError:n}=e;return(0,u.D)({mutationFn:async e=>{let{data:t}=await i.post("/v1/partner/create",e);return t},onSuccess:t,onError:n})},A=e=>{let{onSuccess:t,onError:n}=e;return(0,u.D)({mutationFn:async e=>{let{id:t,payload:n}=e,{data:a}=await i.put("/v1/partner/update/".concat(t),n);return a},onSuccess:t,onError:n})},p=e=>{let{onSuccess:t,onError:n}=e;return(0,u.D)({mutationFn:async e=>{let{data:t}=await i.delete("/v1/partner/delete/".concat(e));return t},onSuccess:t,onError:n})},m=e=>{let{params:t,onSuccess:n,onError:a}=e;return(0,l.a)({queryKey:["ApiGetAllPublication",t],queryFn:async()=>{let{data:e}=await i.get("/v1/publications/getall",{params:t});return e},keepPreviousData:!0,retry:3,onSuccess:n,onError:a})},v=e=>{let{id:t,onSuccess:n,onError:a}=e;return(0,l.a)({queryKey:["ApiGetOnePublication",t],queryFn:async()=>{let{data:e}=await i.get("/v1/publications/getdetail/".concat(t));return e},enabled:!1,onSuccess:n,onError:a})},h=e=>{let{onSuccess:t,onError:n}=e;return(0,u.D)({mutationFn:async e=>{let{data:t}=await i.post("/v1/publications/create",e);return t},onSuccess:t,onError:n})},f=e=>{let{onSuccess:t,onError:n}=e;return(0,u.D)({mutationFn:async e=>{let{id:t,payload:n}=e,{data:a}=await i.put("/v1/publications/update/".concat(t),n);return a},onSuccess:t,onError:n})},g=e=>{let{onSuccess:t,onError:n}=e;return(0,u.D)({mutationFn:async e=>{let{data:t}=await i.delete("/v1/publications/delete/".concat(e));return t},onSuccess:t,onError:n})},y=e=>{let{params:t,onSuccess:n,onError:a}=e;return(0,l.a)({queryKey:["ApiGetAllMainServices",t],queryFn:async()=>{let{data:e}=await i.get("/v1/main_services/getall",{params:t});return e},keepPreviousData:!0,retry:3,onSuccess:n,onError:a})},b=e=>{let{id:t,onSuccess:n,onError:a}=e;return(0,l.a)({queryKey:["ApiGetOneMainServices",t],queryFn:async()=>{let{data:e}=await i.get("/v1/main_services/getdetail/".concat(t));return e},enabled:!1,onSuccess:n,onError:a})},x=e=>{let{onSuccess:t,onError:n}=e;return(0,u.D)({mutationFn:async e=>{let{data:t}=await i.post("/v1/main_services/create",e);return t},onSuccess:t,onError:n})},w=e=>{let{onSuccess:t,onError:n}=e;return(0,u.D)({mutationFn:async e=>{let{id:t,payload:n}=e,{data:a}=await i.put("/v1/main_services/update/".concat(t),n);return a},onSuccess:t,onError:n})},j=e=>{let{onSuccess:t,onError:n}=e;return(0,u.D)({mutationFn:async e=>{let{data:t}=await i.delete("/v1/main_services/delete/".concat(e));return t},onSuccess:t,onError:n})},k=e=>{let{id:t,params:n,onSuccess:a,onError:r}=e;return(0,l.a)({queryKey:["ApiGetAllServices",n],queryFn:async()=>{let{data:e}=await i.get("/v1/services/getall/".concat(t),{params:n});return e},keepPreviousData:!0,retry:3,onSuccess:a,onError:r})},E=e=>{let{id:t,onSuccess:n,onError:a}=e;return(0,l.a)({queryKey:["ApiGetOneServices",t],queryFn:async()=>{let{data:e}=await i.get("/v1/services/getdetail/".concat(t));return e},enabled:!1,onSuccess:n,onError:a})},F=e=>{let{onSuccess:t,onError:n}=e;return(0,u.D)({mutationFn:async e=>{let{data:t}=await i.post("/v1/services/create",e);return t},onSuccess:t,onError:n})},D=e=>{let{onSuccess:t,onError:n}=e;return(0,u.D)({mutationFn:async e=>{let{id:t,payload:n}=e,{data:a}=await i.put("/v1/services/update/".concat(t),n);return a},onSuccess:t,onError:n})},P=e=>{let{onSuccess:t,onError:n}=e;return(0,u.D)({mutationFn:async e=>{let{data:t}=await i.delete("/v1/services/delete/".concat(e));return t},onSuccess:t,onError:n})}},4821:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return y}});var a=n(5893),r=n(7294),i=n(9008),l=n.n(i),u=n(3299),s=n(5121),c=n(2175),o=n(2783),d=n(48),A=n(1580),p=n(4398),m=n(1032),v=n(9488),h=n(1951),f=n(8545),g=function(){let{slug:e,NextRouter:t}=(0,m.Z)();(0,v.Z)();let n=e[0],i=e[1],[l,u]=r.useState(!1),[g,y]=(0,r.useState)(!1),b=(0,c.TA)({initialValues:{title:"",photo:"",description:"",image:"",createdAt:"",updatedAt:""},onSubmit:async e=>{if(/\d/.test(e.name)){alert("Nama Publication Hanya boleh huruf");return}await F(e)}}),x=(e,t)=>{b.setFieldValue(t,e)},w=e=>{if(!e){x("","photo");return}if(!["image/jpeg","image/png","application/pdf"].includes(e.type)){console.error("Invalid file type. Please select a valid image file.");return}x(e,"photo")},j=(0,h.IL)({id:i,onSuccess(e){let{data:t}=e;b.setValues({...b.values,title:t.title,photo:null==t?void 0:t.image,image:null==t?void 0:t.image,description:null==t?void 0:t.description,createdAt:null==t?void 0:t.createdAt,updatedAt:null==t?void 0:t.updatedAt});let n=document.getElementById("editor"),a=null==t?void 0:t.description;a&&(n.innerHTML=a)},onError(e){console.error(e)}});r.useEffect(()=>{"edit"===n&&j.refetch()},[i,n]);let k=(0,h.K6)({onSuccess(){alert("Berhasil menambah Data"),t.replace("/admin/publication"),b.setSubmitting(!1),y(!1)},onError(e){if(b.setSubmitting(!1),y(!1),s.Z.isAxiosError(e)){var t,n;let a=null===(t=e.response)||void 0===t?void 0:t.status;422===a?alert(null===(n=e.response)||void 0===n?void 0:n.data.message):alert("Telah terjadi kesalahan saat Menambah Data.")}console.error(e)}}),E=(0,h.UJ)({onSuccess(){alert("Berhasil mengubah Data Publikasi"),t.replace("/admin/publication"),b.setSubmitting(!1),y(!1)},onError(e){if(b.setSubmitting(!1),y(!1),s.Z.isAxiosError(e)){var t,n;let a=null===(t=e.response)||void 0===t?void 0:t.status;422===a?alert(null===(n=e.response)||void 0===n?void 0:n.data.message):alert("Telah terjadi kesalahan saat Mengubah Data.")}console.error(e)}}),F=async e=>{b.setSubmitting(!0),y(!0);let t=new FormData;Object.keys(e).map(n=>{(null==e?void 0:e[n])!=null&&"categories_id"!==n&&"image"!=n&&"updatedAt"!==n&&"createdAt"!==n&&t.set(n,null==e?void 0:e[n])}),"add"===n?k.mutate(t):E.mutate({id:i,payload:t})};return r.useLayoutEffect(()=>{let e=document.getElementById("editor");e.addEventListener("input",()=>{let t=e.innerHTML;null==b||b.setFieldValue("description",t)})},[]),(0,r.useEffect)(()=>{console.log("cek formikPublication",null==b?void 0:b.values)},[b]),(0,a.jsxs)(r.Fragment,{children:[(0,a.jsx)("div",{className:"mx-0 mb-8 hidden h-12 w-full items-center border-b-2 border-solid border-ui-gray-blue-90 md:flex",children:(0,a.jsx)(o.Z,{item:[{title:"Kelola Kategori Publication",linkTo:"/admin/publication"},{title:"add"===n?"Tambah Kategori":"Edit Kategori",active:!0}],className:"ml-4"})}),(0,a.jsx)("div",{className:"md:mx-4 md:w-3/4",children:(0,a.jsxs)("form",{className:"flex w-full flex-col gap-4",onSubmit:b.handleSubmit,children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(p.Z,{htmlFor:"nama",children:["Judul Publikasi\xa0",(0,a.jsx)("sup",{className:"font-black text-ui-red",children:"*"})]}),(0,a.jsx)(A.Z,{type:"text",name:"title",placeholder:"Judul Publikasi",onChange:b.handleChange,value:b.values.title,requiredMessages:"Judul Publikasi tidak boleh kosong!",required:!0})]}),(0,a.jsxs)("div",{className:"w-6/12",children:[(0,a.jsxs)(p.Z,{htmlFor:"noTelp",children:["Upload Foto\xa0",(0,a.jsx)("sup",{className:"font-black text-ui-red",children:"*"})]}),(0,a.jsx)(f.Z,{name:"photo",placeholder:"Upload",value:b.values.photo,accept:"image/*",onChange:e=>w(e),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(p.Z,{htmlFor:"noTelp",children:["Deskripsi\xa0",(0,a.jsx)("sup",{className:"font-black text-ui-red",children:"*"})]}),(0,a.jsx)("div",{id:"editor",contentEditable:!0,style:{width:"100%",minHeight:500,border:"1px solid #ccc",padding:4,boxSizing:"border-box",backgroundColor:"white"}})]}),(0,a.jsx)("div",{className:"flex w-full md:flex",children:(0,a.jsx)(d.Z,{type:"submit",disabled:g,children:g?"Menyimpan...":"Simpan"})})]})})]})},y=function(){let{NextRouter:e}=(0,m.Z)(),{data:t,status:n}=(0,u.useSession)();return"loading"===n?null:"unauthenticated"===n?(e.replace("/login"),null):"authenticated"===n&&(null==t?void 0:t.user.role)!=="admin"?(e.replace("/karyawan"),null):(0,a.jsxs)(r.Fragment,{children:[(0,a.jsxs)(l(),{children:[(0,a.jsx)("title",{children:"Has Law | Publication"}),(0,a.jsx)("meta",{name:"description",content:"Has Law | Publication"})]}),(0,a.jsx)(g,{})]})}}},function(e){e.O(0,[957,641,175,53,774,888,179],function(){return e(e.s=3719)}),_N_E=e.O()}]);