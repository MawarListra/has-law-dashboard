(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[915],{3719:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/publication/[...addEdit]",function(){return n(4821)}])},8545:function(e,t,n){"use strict";n.d(t,{Z:function(){return A}});var a=n(5893),r=n(7294),i=n(5675),l=n.n(i),s=n(7414),u=n(3230),o=n(6527),c=n(9003),d={src:"/_next/static/media/pdf-icon.b1c4466b.jpeg",height:640,width:640,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wAARCAAIAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAf/xAAfEAACAAUFAAAAAAAAAAAAAAAAEQECAxIxBBUhQVH/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8Aol2v3tqeFC7CmUel4ly8AAD/2Q==",blurWidth:8,blurHeight:8},A=function(e){let{name:t,value:n,accept:i,placeholder:A,onChange:p}=e,[v,m]=(0,r.useState)(void 0),h=r.useRef(null),f=e=>{let t=e.target.name,n=e.target.value,a=e.target.files;if(!a||(null==a?void 0:a.length)===0)return;let r=a[0];if(!r.type.includes("image/")&&!r.type.includes("application/pdf")){h.current&&(h.current.value="");return}(null==r?void 0:r.type)==="application/pdf"?m(r):m(void 0),null==p||p(r,{name:t,value:n})};return(0,a.jsxs)(r.Fragment,{children:[n||v?(0,a.jsxs)("div",{className:"relative",children:[v&&void 0!==v?(0,a.jsx)("div",{onClick:()=>{let e=document.createElement("a");e.href=URL.createObjectURL(v||new Blob),e.target="_blank",e.download="".concat(t,".pdf"),e.click()},children:(0,a.jsx)(l(),{className:"img-fluid flex ",src:v?d:"",alt:"Test",width:200,height:150})}):(0,a.jsx)(l(),{className:"img-fluid flex",src:n instanceof Blob?URL.createObjectURL(n):"".concat("https://has.chicodeapi.xyz","/").concat(n),alt:"Test",width:200,height:150}),(0,a.jsxs)("div",{className:"absolute top-3 flex justify-between",style:{width:"200px"},children:[(0,a.jsx)(s.Ei,{className:"mr-2",title:"Ubah Gambar",onClick:()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.click()},children:(0,a.jsx)(o.Z,{color:"blue",size:4})}),(0,a.jsx)(s.Ei,{title:"Hapus Gambar",onClick:()=>{var e;null==p||p(null,{name:null===(e=h.current)||void 0===e?void 0:e.name,value:""}),m(void 0)},children:(0,a.jsx)(c.Z,{color:"red",size:4})})]})]}):(0,a.jsx)(s.UP,{className:"cursor-default",iconRight:(0,a.jsx)(u.Z,{}),onClick:()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.click()},readOnly:!0,name:t,placeholder:A}),(0,a.jsx)("input",{name:t,ref:h,type:"file",onChange:e=>{f(e)},hidden:!0,accept:i,multiple:!0})]})}},1951:function(e,t,n){"use strict";n.d(t,{vt:function(){return j},FU:function(){return p},P$:function(){return g},mG:function(){return S},i4:function(){return y},_r:function(){return o},bn:function(){return u},lM:function(){return v},Qy:function(){return k},rr:function(){return b},ef:function(){return c},IL:function(){return m},Lt:function(){return F},rP:function(){return x},$U:function(){return d},K6:function(){return h},Nm:function(){return E},hl:function(){return w},a6:function(){return A},UJ:function(){return f},gy:function(){return D}});var a=n(5121),r=n(3299),i=(()=>{let e=a.Z.create({baseURL:"https://has.chicodeapi.xyz"});return e.interceptors.request.use(async e=>{let t=await (0,r.getSession)();if(t){let n=t.user.apiToken;e.headers.Authorization="Bearer ".concat(n)}return e}),e.interceptors.response.use(e=>e,e=>{if(a.Z.isAxiosError(e)){var t;null===(t=e.response)||void 0===t||t.status}throw e}),e})(),l=n(7848),s=n(8228);let u=e=>{let{params:t,onSuccess:n,onError:a}=e;return(0,l.a)({queryKey:["ApiGetAllPartnerCategories",t],queryFn:async()=>{let{data:e}=await i.get("/v1/partner_categories/getall",{params:t});return e},keepPreviousData:!0,retry:3,onSuccess:n,onError:a})},o=e=>{let{params:t,onSuccess:n,onError:a}=e;return(0,l.a)({queryKey:["ApiGetAllPartner",t],queryFn:async()=>{let{data:e}=await i.get("/v1/partner/getall",{params:t});return e},keepPreviousData:!0,retry:3,onSuccess:n,onError:a})},c=e=>{let{id:t,onSuccess:n,onError:a}=e;return(0,l.a)({queryKey:["ApiGetOnePartner",t],queryFn:async()=>{let{data:e}=await i.get("/v1/partner/getdetail/".concat(t));return e},enabled:!1,onSuccess:n,onError:a})},d=e=>{let{onSuccess:t,onError:n}=e;return(0,s.D)({mutationFn:async e=>{let{data:t}=await i.post("/v1/partner/create",e);return t},onSuccess:t,onError:n})},A=e=>{let{onSuccess:t,onError:n}=e;return(0,s.D)({mutationFn:async e=>{let{id:t,payload:n}=e,{data:a}=await i.put("/v1/partner/update/".concat(t),n);return a},onSuccess:t,onError:n})},p=e=>{let{onSuccess:t,onError:n}=e;return(0,s.D)({mutationFn:async e=>{let{data:t}=await i.delete("/v1/partner/delete/".concat(e));return t},onSuccess:t,onError:n})},v=e=>{let{params:t,onSuccess:n,onError:a}=e;return(0,l.a)({queryKey:["ApiGetAllPublication",t],queryFn:async()=>{let{data:e}=await i.get("/v1/publications/getall",{params:t});return e},keepPreviousData:!0,retry:3,onSuccess:n,onError:a})},m=e=>{let{id:t,onSuccess:n,onError:a}=e;return(0,l.a)({queryKey:["ApiGetOnePublication",t],queryFn:async()=>{let{data:e}=await i.get("/v1/publications/getdetail/".concat(t));return e},enabled:!1,onSuccess:n,onError:a})},h=e=>{let{onSuccess:t,onError:n}=e;return(0,s.D)({mutationFn:async e=>{let{data:t}=await i.post("/v1/publications/create",e);return t},onSuccess:t,onError:n})},f=e=>{let{onSuccess:t,onError:n}=e;return(0,s.D)({mutationFn:async e=>{let{id:t,payload:n}=e,{data:a}=await i.put("/v1/publications/update/".concat(t),n);return a},onSuccess:t,onError:n})},g=e=>{let{onSuccess:t,onError:n}=e;return(0,s.D)({mutationFn:async e=>{let{data:t}=await i.delete("/v1/publications/delete/".concat(e));return t},onSuccess:t,onError:n})},y=e=>{let{params:t,onSuccess:n,onError:a}=e;return(0,l.a)({queryKey:["ApiGetAllMainServices",t],queryFn:async()=>{let{data:e}=await i.get("/v1/main_services/getall",{params:t});return e},keepPreviousData:!0,retry:3,onSuccess:n,onError:a})},b=e=>{let{id:t,onSuccess:n,onError:a}=e;return(0,l.a)({queryKey:["ApiGetOneMainServices",t],queryFn:async()=>{let{data:e}=await i.get("/v1/main_services/getdetail/".concat(t));return e},enabled:!1,onSuccess:n,onError:a})},x=e=>{let{onSuccess:t,onError:n}=e;return(0,s.D)({mutationFn:async e=>{let{data:t}=await i.post("/v1/main_services/create",e);return t},onSuccess:t,onError:n})},w=e=>{let{onSuccess:t,onError:n}=e;return(0,s.D)({mutationFn:async e=>{let{id:t,payload:n}=e,{data:a}=await i.put("/v1/main_services/update/".concat(t),n);return a},onSuccess:t,onError:n})},j=e=>{let{onSuccess:t,onError:n}=e;return(0,s.D)({mutationFn:async e=>{let{data:t}=await i.delete("/v1/main_services/delete/".concat(e));return t},onSuccess:t,onError:n})},k=e=>{let{id:t,params:n,onSuccess:a,onError:r}=e;return(0,l.a)({queryKey:["ApiGetAllServices",n],queryFn:async()=>{let{data:e}=await i.get("/v1/services/getall/".concat(t),{params:n});return e},keepPreviousData:!0,retry:3,onSuccess:a,onError:r})},F=e=>{let{id:t,onSuccess:n,onError:a}=e;return(0,l.a)({queryKey:["ApiGetOneServices",t],queryFn:async()=>{let{data:e}=await i.get("/v1/services/getdetail/".concat(t));return e},enabled:!1,onSuccess:n,onError:a})},E=e=>{let{onSuccess:t,onError:n}=e;return(0,s.D)({mutationFn:async e=>{let{data:t}=await i.post("/v1/services/create",e);return t},onSuccess:t,onError:n})},D=e=>{let{onSuccess:t,onError:n}=e;return(0,s.D)({mutationFn:async e=>{let{id:t,payload:n}=e,{data:a}=await i.put("/v1/services/update/".concat(t),n);return a},onSuccess:t,onError:n})},S=e=>{let{onSuccess:t,onError:n}=e;return(0,s.D)({mutationFn:async e=>{let{data:t}=await i.delete("/v1/services/delete/".concat(e));return t},onSuccess:t,onError:n})}},4821:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return w}});var a=n(5893),r=n(7294),i=n(9008),l=n.n(i),s=n(3299),u=n(5121),o=n(2175),c=n(2783),d=n(48),A=n(1580),p=n(4398),v=n(1032),m=n(9488),h=n(1951),f=n(8545),g=n(9041);n(6973);var y=n(5490);let b=()=>n.e(925).then(n.t.bind(n,9521,23));var x=function(){let{slug:e,NextRouter:t}=(0,v.Z)();(0,m.Z)();let n=e[0],i=e[1],[l,s]=(0,r.useState)(null);(0,r.useEffect)(()=>{b().then(e=>s(e.Editor))},[]);let[x,w]=(0,r.useState)(!1),j=(0,o.TA)({initialValues:{title:"",photo:"",description:"",image:"",createdAt:"",updatedAt:""},onSubmit:async e=>{if(/\d/.test(e.name)){alert("Nama Publication Hanya boleh huruf");return}await O(e)}}),[k,F]=(0,r.useState)(()=>{var e;let t=(null==j?void 0:null===(e=j.values)||void 0===e?void 0:e.description)||"",n=(0,g.convertFromHTML)(t).contentBlocks,a=g.ContentState.createFromBlockArray(n);return g.EditorState.createWithContent(a)}),E=(e,t)=>{j.setFieldValue(t,e)},D=e=>{if(!e){E("","photo");return}if(!["image/jpeg","image/png","application/pdf"].includes(e.type)){console.error("Invalid file type. Please select a valid image file.");return}E(e,"photo")},S=(0,h.IL)({id:i,onSuccess(e){let{data:t}=e;j.setValues({...j.values,title:t.title,photo:null==t?void 0:t.image,image:null==t?void 0:t.image,description:null==t?void 0:t.description,createdAt:null==t?void 0:t.createdAt,updatedAt:null==t?void 0:t.updatedAt});let n=(null==t?void 0:t.description)||"",a=(0,g.convertFromHTML)(n).contentBlocks,r=g.ContentState.createFromBlockArray(a);F(g.EditorState.createWithContent(r))},onError(e){console.error(e)}});r.useEffect(()=>{"edit"===n&&S.refetch()},[i,n]);let C=(0,h.K6)({onSuccess(){alert("Berhasil menambah Data"),t.replace("/admin/publication"),j.setSubmitting(!1),w(!1)},onError(e){if(j.setSubmitting(!1),w(!1),u.Z.isAxiosError(e)){var t,n;let a=null===(t=e.response)||void 0===t?void 0:t.status;422===a?alert(null===(n=e.response)||void 0===n?void 0:n.data.message):alert("Telah terjadi kesalahan saat Menambah Data.")}console.error(e)}}),P=(0,h.UJ)({onSuccess(){alert("Berhasil mengubah Data Publikasi"),t.replace("/admin/publication"),j.setSubmitting(!1),w(!1)},onError(e){if(j.setSubmitting(!1),w(!1),u.Z.isAxiosError(e)){var t,n;let a=null===(t=e.response)||void 0===t?void 0:t.status;422===a?alert(null===(n=e.response)||void 0===n?void 0:n.data.message):alert("Telah terjadi kesalahan saat Mengubah Data.")}console.error(e)}}),O=async e=>{j.setSubmitting(!0),w(!0);let t=new FormData;Object.keys(e).map(n=>{(null==e?void 0:e[n])!=null&&"categories_id"!==n&&"image"!=n&&"updatedAt"!==n&&"createdAt"!==n&&t.set(n,null==e?void 0:e[n])}),"add"===n?C.mutate(t):P.mutate({id:i,payload:t})};return(0,r.useEffect)(()=>{console.log("cek formikPublication",null==j?void 0:j.values)},[j]),(0,a.jsxs)(r.Fragment,{children:[(0,a.jsx)("div",{className:"mx-0 mb-8 hidden h-12 w-full items-center border-b-2 border-solid border-ui-gray-blue-90 md:flex",children:(0,a.jsx)(c.Z,{item:[{title:"Kelola Kategori Publication",linkTo:"/admin/publication"},{title:"add"===n?"Tambah Kategori":"Edit Kategori",active:!0}],className:"ml-4"})}),(0,a.jsx)("div",{className:"w-full md:mx-4",style:{overflow:"scroll"},children:(0,a.jsxs)("form",{className:"flex w-full flex-col gap-4",onSubmit:j.handleSubmit,children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(p.Z,{htmlFor:"nama",children:["Judul Publikasi\xa0",(0,a.jsx)("sup",{className:"font-black text-ui-red",children:"*"})]}),(0,a.jsx)(A.Z,{type:"text",name:"title",placeholder:"Judul Publikasi",onChange:j.handleChange,value:j.values.title,requiredMessages:"Judul Publikasi tidak boleh kosong!",required:!0})]}),(0,a.jsxs)("div",{className:"w-6/12",children:[(0,a.jsxs)(p.Z,{htmlFor:"noTelp",children:["Upload Foto\xa0",(0,a.jsx)("sup",{className:"font-black text-ui-red",children:"*"})]}),(0,a.jsx)(f.Z,{name:"photo",placeholder:"Upload",value:j.values.photo,accept:"image/*",onChange:e=>D(e),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(p.Z,{htmlFor:"noTelp",children:["Deskripsi\xa0",(0,a.jsx)("sup",{className:"font-black text-ui-red",children:"*"})]}),l&&(0,a.jsx)(l,{editorState:k,onEditorStateChange:e=>{F(e),console.log("cek newState",e);let t=e.getCurrentContent(),n=(0,y.E)(t);j.setFieldValue("description",n)},toolbar:{options:["inline","blockType","list","textAlign","history"],inline:{options:["bold","italic","underline","strikethrough"]},blockType:{options:["Normal","H1","H2","H3","H4","H5","H6","Blockquote"]},list:{options:["unordered","ordered"]}},wrapperStyle:{backgroundColor:"white",maxHeight:300,overflow:"scroll"}})]}),(0,a.jsx)("div",{className:"flex w-full md:flex",children:(0,a.jsx)(d.Z,{type:"submit",disabled:x,children:x?"Menyimpan...":"Simpan"})})]})})]})},w=function(){let{NextRouter:e}=(0,v.Z)(),{data:t,status:n}=(0,s.useSession)();return"loading"===n?null:"unauthenticated"===n?(e.replace("/login"),null):"authenticated"===n&&(null==t?void 0:t.user.role)!=="admin"?(e.replace("/karyawan"),null):(0,a.jsxs)(r.Fragment,{children:[(0,a.jsxs)(l(),{children:[(0,a.jsx)("title",{children:"Has Law | Publication"}),(0,a.jsx)("meta",{name:"description",content:"Has Law | Publication"})]}),(0,a.jsx)(x,{})]})}}},function(e){e.O(0,[957,641,175,490,53,774,888,179],function(){return e(e.s=3719)}),_N_E=e.O()}]);