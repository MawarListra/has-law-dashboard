"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[158],{3158:function(e,t,a){var r=a(5893),n=a(7294),i=a(5121),l=a(2175),s=a(2783),u=a(48),o=a(1580),c=a(4398),d=a(1032),A=a(9488),m=a(1951),p=a(7414),v=a(8545);t.Z=function(){let{slug:e,NextRouter:t}=(0,d.Z)();(0,A.Z)();let a=e[0],h=e[1],[g,f]=n.useState(!1),[y,x]=(0,n.useState)(!1),[b,w]=(0,n.useState)([{value:0,label:""}]),j=(0,l.TA)({initialValues:{name:"",photo:"",categories:"",description:"",image:"",categories_id:0},onSubmit:async e=>{if(/\d/.test(e.name)){alert("Nama Partner Hanya boleh huruf");return}await S(e)}}),F=(e,t)=>{j.setFieldValue(t,e)},D=e=>{if(!e){F("","photo");return}if(!["image/jpeg","image/png","application/pdf"].includes(e.type)){console.error("Invalid file type. Please select a valid image file.");return}F(e,"photo")};(0,m.bn)({params:{page:1},onSuccess(e){let{data:t}=e,a=[];t.map(e=>{a.push({value:null==e?void 0:e.id,label:null==e?void 0:e.name})}),w(a)},onError(e){console.error(e)}});let k=(0,m.ef)({id:h,onSuccess(e){let{data:t}=e;j.setValues({...j.values,name:t.name,photo:null==t?void 0:t.image,image:null==t?void 0:t.image,description:null==t?void 0:t.description,categories:null==t?void 0:t.categories,categories_id:null==t?void 0:t.categories_id});let a=document.getElementById("editor"),r=null==t?void 0:t.description;r&&(a.innerHTML=r)},onError(e){console.error(e)}});n.useEffect(()=>{"edit"===a&&k.refetch()},[h,a]);let E=(0,m.$U)({onSuccess(){alert("Berhasil menambah Data"),t.replace("/admin/partner"),j.setSubmitting(!1),x(!1)},onError(e){if(j.setSubmitting(!1),x(!1),i.Z.isAxiosError(e)){var t,a;let r=null===(t=e.response)||void 0===t?void 0:t.status;422===r?alert(null===(a=e.response)||void 0===a?void 0:a.data.message):alert("Telah terjadi kesalahan saat Menambah Data.")}console.error(e)}}),N=(0,m.a6)({onSuccess(){alert("Berhasil mengubah Data Partner"),t.replace("/admin/partner"),j.setSubmitting(!1),x(!1)},onError(e){if(j.setSubmitting(!1),x(!1),i.Z.isAxiosError(e)){var t,a;let r=null===(t=e.response)||void 0===t?void 0:t.status;422===r?alert(null===(a=e.response)||void 0===a?void 0:a.data.message):alert("Telah terjadi kesalahan saat Mengubah Data.")}console.error(e)}}),S=async e=>{j.setSubmitting(!0),x(!0);let t=new FormData;Object.keys(e).map(a=>{(null==e?void 0:e[a])!=null&&"categories_id"!==a&&"image"!=a&&t.set(a,null==e?void 0:e[a])}),"add"===a?E.mutate(t):N.mutate({id:h,payload:t})};return n.useLayoutEffect(()=>{let e=document.getElementById("editor");e.addEventListener("input",()=>{let t=e.innerHTML;null==j||j.setFieldValue("description",t)})},[]),(0,n.useEffect)(()=>{console.log("cek formikPartner",null==j?void 0:j.values)},[j]),(0,r.jsxs)(n.Fragment,{children:[(0,r.jsx)("div",{className:"mx-0 mb-8 hidden h-12 w-full items-center border-b-2 border-solid border-ui-gray-blue-90 md:flex",children:(0,r.jsx)(s.Z,{item:[{title:"Kelola Kategori Partner",linkTo:"/admin/partner"},{title:"add"===a?"Tambah Kategori":"Edit Kategori",active:!0}],className:"ml-4"})}),(0,r.jsx)("div",{className:"md:mx-4 md:w-3/4",children:(0,r.jsxs)("form",{className:"flex w-full flex-col gap-4",onSubmit:j.handleSubmit,children:[(0,r.jsxs)("div",{className:"w-6/12",children:[(0,r.jsxs)(c.Z,{htmlFor:"noTelp",children:["Pilih Kategori\xa0",(0,r.jsx)("sup",{className:"font-black text-ui-red",children:"*"})]}),(0,r.jsx)(p.JD,{name:"package_id",placeholder:"Pilih Paket",value:j.values.categories_id,option:b,onChange:e=>{j.setFieldValue("categories_id",null==e?void 0:e.value),j.setFieldValue("categories",null==e?void 0:e.label)},required:!0})]}),(0,r.jsxs)("div",{className:"w-6/12",children:[(0,r.jsxs)(c.Z,{htmlFor:"nama",children:["Nama\xa0",(0,r.jsx)("sup",{className:"font-black text-ui-red",children:"*"})]}),(0,r.jsx)(o.Z,{type:"text",name:"name",placeholder:"Nama",onChange:j.handleChange,value:j.values.name,requiredMessages:"Nama tidak boleh kosong!",required:!0})]}),(0,r.jsxs)("div",{className:"w-6/12",children:[(0,r.jsxs)(c.Z,{htmlFor:"noTelp",children:["Upload Foto\xa0",(0,r.jsx)("sup",{className:"font-black text-ui-red",children:"*"})]}),(0,r.jsx)(v.Z,{name:"photo",placeholder:"Upload",value:j.values.photo,accept:"image/*",onChange:e=>D(e),required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)(c.Z,{htmlFor:"noTelp",children:["Deskripsi\xa0",(0,r.jsx)("sup",{className:"font-black text-ui-red",children:"*"})]}),(0,r.jsx)("div",{id:"editor",contentEditable:!0,style:{width:"100%",minHeight:500,border:"1px solid #ccc",padding:4,boxSizing:"border-box",backgroundColor:"white"}})]}),(0,r.jsx)("div",{className:"flex w-full md:flex",children:(0,r.jsx)(u.Z,{type:"submit",disabled:y,children:y?"Menyimpan...":"Simpan"})})]})})]})}},8545:function(e,t,a){a.d(t,{Z:function(){return A}});var r=a(5893),n=a(7294),i=a(5675),l=a.n(i),s=a(7414),u=a(3230),o=a(6527),c=a(9003),d={src:"/_next/static/media/pdf-icon.b1c4466b.jpeg",height:640,width:640,blurDataURL:"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wAARCAAIAAgDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAf/xAAfEAACAAUFAAAAAAAAAAAAAAAAEQECAxIxBBUhQVH/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8Aol2v3tqeFC7CmUel4ly8AAD/2Q==",blurWidth:8,blurHeight:8},A=function(e){let{name:t,value:a,accept:i,placeholder:A,onChange:m}=e,[p,v]=(0,n.useState)(void 0),h=n.useRef(null),g=e=>{let t=e.target.name,a=e.target.value,r=e.target.files;if(!r||(null==r?void 0:r.length)===0)return;let n=r[0];if(!n.type.includes("image/")&&!n.type.includes("application/pdf")){h.current&&(h.current.value="");return}(null==n?void 0:n.type)==="application/pdf"?v(n):v(void 0),null==m||m(n,{name:t,value:a})};return(0,r.jsxs)(n.Fragment,{children:[a||p?(0,r.jsxs)("div",{className:"relative",children:[p&&void 0!==p?(0,r.jsx)("div",{onClick:()=>{let e=document.createElement("a");e.href=URL.createObjectURL(p||new Blob),e.target="_blank",e.download="".concat(t,".pdf"),e.click()},children:(0,r.jsx)(l(),{className:"img-fluid flex ",src:p?d:"",alt:"Test",width:200,height:150})}):(0,r.jsx)(l(),{className:"img-fluid flex",src:a instanceof Blob?URL.createObjectURL(a):"".concat("https://has.chicodeapi.xyz","/").concat(a),alt:"Test",width:200,height:150}),(0,r.jsxs)("div",{className:"absolute top-3 flex justify-between",style:{width:"200px"},children:[(0,r.jsx)(s.Ei,{className:"mr-2",title:"Ubah Gambar",onClick:()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.click()},children:(0,r.jsx)(o.Z,{color:"blue",size:4})}),(0,r.jsx)(s.Ei,{title:"Hapus Gambar",onClick:()=>{var e;null==m||m(null,{name:null===(e=h.current)||void 0===e?void 0:e.name,value:""}),v(void 0)},children:(0,r.jsx)(c.Z,{color:"red",size:4})})]})]}):(0,r.jsx)(s.UP,{className:"cursor-default",iconRight:(0,r.jsx)(u.Z,{}),onClick:()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.click()},readOnly:!0,name:t,placeholder:A}),(0,r.jsx)("input",{name:t,ref:h,type:"file",onChange:e=>{g(e)},hidden:!0,accept:i,multiple:!0})]})}},1951:function(e,t,a){a.d(t,{vt:function(){return j},FU:function(){return m},P$:function(){return f},mG:function(){return N},i4:function(){return y},_r:function(){return o},bn:function(){return u},lM:function(){return p},Qy:function(){return F},rr:function(){return x},ef:function(){return c},IL:function(){return v},Lt:function(){return D},rP:function(){return b},$U:function(){return d},K6:function(){return h},Nm:function(){return k},hl:function(){return w},a6:function(){return A},UJ:function(){return g},gy:function(){return E}});var r=a(5121),n=a(3299),i=(()=>{let e=r.Z.create({baseURL:"https://has.chicodeapi.xyz"});return e.interceptors.request.use(async e=>{let t=await (0,n.getSession)();if(t){let a=t.user.apiToken;e.headers.Authorization="Bearer ".concat(a)}return e}),e.interceptors.response.use(e=>e,e=>{if(r.Z.isAxiosError(e)){var t;null===(t=e.response)||void 0===t||t.status}throw e}),e})(),l=a(7848),s=a(8228);let u=e=>{let{params:t,onSuccess:a,onError:r}=e;return(0,l.a)({queryKey:["ApiGetAllPartnerCategories",t],queryFn:async()=>{let{data:e}=await i.get("/v1/partner_categories/getall",{params:t});return e},keepPreviousData:!0,retry:3,onSuccess:a,onError:r})},o=e=>{let{params:t,onSuccess:a,onError:r}=e;return(0,l.a)({queryKey:["ApiGetAllPartner",t],queryFn:async()=>{let{data:e}=await i.get("/v1/partner/getall",{params:t});return e},keepPreviousData:!0,retry:3,onSuccess:a,onError:r})},c=e=>{let{id:t,onSuccess:a,onError:r}=e;return(0,l.a)({queryKey:["ApiGetOnePartner",t],queryFn:async()=>{let{data:e}=await i.get("/v1/partner/getdetail/".concat(t));return e},enabled:!1,onSuccess:a,onError:r})},d=e=>{let{onSuccess:t,onError:a}=e;return(0,s.D)({mutationFn:async e=>{let{data:t}=await i.post("/v1/partner/create",e);return t},onSuccess:t,onError:a})},A=e=>{let{onSuccess:t,onError:a}=e;return(0,s.D)({mutationFn:async e=>{let{id:t,payload:a}=e,{data:r}=await i.put("/v1/partner/update/".concat(t),a);return r},onSuccess:t,onError:a})},m=e=>{let{onSuccess:t,onError:a}=e;return(0,s.D)({mutationFn:async e=>{let{data:t}=await i.delete("/v1/partner/delete/".concat(e));return t},onSuccess:t,onError:a})},p=e=>{let{params:t,onSuccess:a,onError:r}=e;return(0,l.a)({queryKey:["ApiGetAllPublication",t],queryFn:async()=>{let{data:e}=await i.get("/v1/publications/getall",{params:t});return e},keepPreviousData:!0,retry:3,onSuccess:a,onError:r})},v=e=>{let{id:t,onSuccess:a,onError:r}=e;return(0,l.a)({queryKey:["ApiGetOnePublication",t],queryFn:async()=>{let{data:e}=await i.get("/v1/publications/getdetail/".concat(t));return e},enabled:!1,onSuccess:a,onError:r})},h=e=>{let{onSuccess:t,onError:a}=e;return(0,s.D)({mutationFn:async e=>{let{data:t}=await i.post("/v1/publications/create",e);return t},onSuccess:t,onError:a})},g=e=>{let{onSuccess:t,onError:a}=e;return(0,s.D)({mutationFn:async e=>{let{id:t,payload:a}=e,{data:r}=await i.put("/v1/publications/update/".concat(t),a);return r},onSuccess:t,onError:a})},f=e=>{let{onSuccess:t,onError:a}=e;return(0,s.D)({mutationFn:async e=>{let{data:t}=await i.delete("/v1/publications/delete/".concat(e));return t},onSuccess:t,onError:a})},y=e=>{let{params:t,onSuccess:a,onError:r}=e;return(0,l.a)({queryKey:["ApiGetAllMainServices",t],queryFn:async()=>{let{data:e}=await i.get("/v1/main_services/getall",{params:t});return e},keepPreviousData:!0,retry:3,onSuccess:a,onError:r})},x=e=>{let{id:t,onSuccess:a,onError:r}=e;return(0,l.a)({queryKey:["ApiGetOneMainServices",t],queryFn:async()=>{let{data:e}=await i.get("/v1/main_services/getdetail/".concat(t));return e},enabled:!1,onSuccess:a,onError:r})},b=e=>{let{onSuccess:t,onError:a}=e;return(0,s.D)({mutationFn:async e=>{let{data:t}=await i.post("/v1/main_services/create",e);return t},onSuccess:t,onError:a})},w=e=>{let{onSuccess:t,onError:a}=e;return(0,s.D)({mutationFn:async e=>{let{id:t,payload:a}=e,{data:r}=await i.put("/v1/main_services/update/".concat(t),a);return r},onSuccess:t,onError:a})},j=e=>{let{onSuccess:t,onError:a}=e;return(0,s.D)({mutationFn:async e=>{let{data:t}=await i.delete("/v1/main_services/delete/".concat(e));return t},onSuccess:t,onError:a})},F=e=>{let{id:t,params:a,onSuccess:r,onError:n}=e;return(0,l.a)({queryKey:["ApiGetAllServices",a],queryFn:async()=>{let{data:e}=await i.get("/v1/services/getall/".concat(t),{params:a});return e},keepPreviousData:!0,retry:3,onSuccess:r,onError:n})},D=e=>{let{id:t,onSuccess:a,onError:r}=e;return(0,l.a)({queryKey:["ApiGetOneServices",t],queryFn:async()=>{let{data:e}=await i.get("/v1/services/getdetail/".concat(t));return e},enabled:!1,onSuccess:a,onError:r})},k=e=>{let{onSuccess:t,onError:a}=e;return(0,s.D)({mutationFn:async e=>{let{data:t}=await i.post("/v1/services/create",e);return t},onSuccess:t,onError:a})},E=e=>{let{onSuccess:t,onError:a}=e;return(0,s.D)({mutationFn:async e=>{let{id:t,payload:a}=e,{data:r}=await i.put("/v1/services/update/".concat(t),a);return r},onSuccess:t,onError:a})},N=e=>{let{onSuccess:t,onError:a}=e;return(0,s.D)({mutationFn:async e=>{let{data:t}=await i.delete("/v1/services/delete/".concat(e));return t},onSuccess:t,onError:a})}}}]);